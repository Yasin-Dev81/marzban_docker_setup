services:
  marzban:
    container_name: marzban_panel_main
    image: gozargah/marzban:latest
    restart: always
    env_file: .env
    network_mode: host
    volumes:
      - /var/lib/marzban:/var/lib/marzban
      - ./index.html:/code/app/templates/subscription/index.html

    expose:
      - "8000"

  nginx:
    container_name: marzban_nginx_main
    command: nginx -g 'daemon off;'
    depends_on:
      - marzban_panel_main
    image: nginx:latest
    networks:
      - main
    ports:
      - "80:80"
    restart: always
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      # ------------------------- set domain
      - /etc/letsencrypt/live/example.com/fullchain.pem:/cert/fullchain.pem
      - /etc/letsencrypt/live/example.com/privkey.pem:/cert/key.pem
