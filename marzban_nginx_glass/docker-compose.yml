services:
  marzban:
    container_name: marzban_panel
    image: gozargah/marzban:latest
    restart: always
    env_file: .env
    # network_mode: host
    networks: # -------------------------------- set network
      - main
    volumes:
      - /var/lib/marzban:/var/lib/marzban
      - ./index.html:/code/app/templates/subscription/index.html
    expose:
      - "8000"

  glass:
    container_name: marzban_glass_server
    image: wikihostinc/looking-glass-server:latest
    restart: always
    # network_mode: host
    networks: # --------------------------------- set network
      - user_yasin
    environment:
      - HTTP_PORT=80
      - SPONSOR_MESSAGE=Powered by yasin-dev81.ir
      - SPEEDTEST_FILE_LIST=1MB 10MB 100MB
    depends_on:
      - marzban

  nginx:
    container_name: marzban_nginx
    command: nginx -g 'daemon off;'
    depends_on:
      - marzban
    image: nginx:latest
    networks: # --------------------------------- set network
      - user_yasin
    ports:
      - "443:443"
      - "80:80"
    restart: always
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf


networks:
  user_yasin:
    name: user_yasin
    driver: host
